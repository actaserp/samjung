<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<style>
    #chartModal .modal-content {
        width: 80vw;
        height: 80vh;
        max-width: 800px; /
        max-height: 600px;
    }
    #modalChartHolder {
        width: 100%;
        height: 100%;
    }

</style>
<th:block layout:fragment="content">

    <!--- (Î†àÏù¥ÏïÑÏõÉ) Contents ÏòÅÏó≠ -->
    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap" style="margin-bottom:0">
            <div class="left">
                <h2>Í¥ÄÎ¶¨Ïûê Dashboard</h2><a id="toggleButton" onclick="toggleSearchWrap()"><img
                    src="/images/icon/ico-down.png"
                    alt="ÏïåÎûå ÏïÑÏù¥ÏΩò"></a>
                <img src="/images/icon/exclamation/exclamation-circle.svg"
                     class="zoom-img"
                     onclick="openPopup('https://foms.atlassian.net/wiki/external/NWNjZGViOTExNzhiNGQ1OGE3ZDk2MTlkMzEwOWE2M2I')" alt="ÎèÑÏõÄÎßê">
                <!--                <a title="Î∂ÅÎßàÌÅ¨" class="bookmark toggle">-->
                <!--                    ÎÇ¥ Î©îÎâ¥-->
                <!--                </a>-->
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="ÌôàÏïÑÏù¥ÏΩò"></li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap" id="searchWrap" style="display: none; padding-top:10px">
            <ul>
                <li>
                    <select title="ÏÇ¨ÏóÖÏû•" id="search_spjangcd" name="search_sjangcd"
                            onchange="init()">
                        <option value="" hidden selected disabled>ÏÑ†ÌÉù</option>
                        <option value="ZZ">ÏÇºÏ†ïÏóòÎ¶¨Î≤†Ïù¥ÌÑ∞</option>
                        <option value="PP">ÏÇºÏ†ïÏóòÎ¶¨Î≤†Ïù¥ÌÑ∞(ÏùºÏÇ∞)</option>
                    </select>
                </li>
            </ul>
        </div>
        <div class="row row-1" style="margin-bottom: 0;">
            <div class="card-wrap swiper card-swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide" data-index="1">
                        <section class="cancel">
                            <div class="title">
                                <h3>Ï£ºÎ¨∏ Ï∑®ÏÜå</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ïò¨Ìï¥ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                    <div class="swiper-slide" data-index="2">
                        <section class="request">
                            <div class="title">
                                <h3 id="requestDate">Ï£ºÎ¨∏Îì±Î°ù</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ï†ÑÎÖÑÎåÄÎπÑ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
<!--                            <dl>-->
<!--                                <dt>Ï†ÑÏùºÎåÄÎπÑ</dt>-->
<!--                                <dd>-->
<!--                                    <span class="down"></span> 1.20 <span class="unit">%</span>-->
<!--                                </dd>-->
<!--                            </dl>-->
                        </section>
                    </div>
                    <div class="swiper-slide" data-index="3">
                        <section class="check">
                            <div class="title">
                                <h3>Ï£ºÎ¨∏ÌôïÏù∏</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ïò¨Ìï¥ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
                            <!--                            <dl>-->
                            <!--                                <dt>Ï†ÑÏùºÎåÄÎπÑ</dt>-->
                            <!--                                <dd>-->
                            <!--                                    <span class="down"></span> 1.20 <span class="unit">%</span>-->
                            <!--                                </dd>-->
                            <!--                            </dl>-->
                        </section>
                    </div>
                    <div class="swiper-slide" data-index="4">
                        <section class="order">
                            <div class="title">
                                <h3>Ï£ºÎ¨∏ÌôïÏ†ï</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ïò¨Ìï¥ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
<!--                            <dl>-->
<!--                                <dt>Ï†ÑÏùºÎåÄÎπÑ</dt>-->
<!--                                <dd>-->
<!--                                    <span class="up"></span> 2.20 <span class="unit">%</span>-->
<!--                                </dd>-->
<!--                            </dl>-->
                        </section>
                    </div>
                    <div class="swiper-slide" data-index="5">
                        <section class="product">
                            <div class="title">
                                <h3>Ï†úÏûëÏßÑÌñâ</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ïò¨Ìï¥ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
<!--                            <dl>-->
<!--                                <dt>Ï†ÑÏùºÎåÄÎπÑ</dt>-->
<!--                                <dd>-->
<!--                                    <span class="down"></span> 1.20 <span class="unit">%</span>-->
<!--                                </dd>-->
<!--                            </dl>-->
                        </section>
                    </div>
                    <div class="swiper-slide" data-index="6">
                        <section class="delivery">
                            <div class="title">
                                <h3>Ï∂úÍ≥†</h3>
                                <a href="#" title="ÎçîÎ≥¥Í∏∞" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>Ïò¨Ìï¥ Í±¥Ïàò</dt>
                                <dd>
                                    <span class="up"></span> - <span class="unit">Í±¥</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                </div> <!--//swiper-wrapper end -->
            </div> <!--//main-card-wrap end -->
        </div>

      <div class="col wp100">
        <section style="padding-top: 5px; padding-bottom: 5px; margin-bottom: 0;">
          <div class="title-wrap">
            <ul class="tab-links-sub">
              <li>
                <a href="#tab1" title="Ï£ºÎ¨∏ÏùòÎ¢∞ Í±¥Ïàò"></a>
              </li>
              <li>
                <a href="#tab2" title="Ï†ÑÎÖÑÎåÄÎπÑ Í±¥Ïàò"></a>
              </li>
              <li>
                <a href="#tab3" title="ÎãπÏõî Í±¥Ïàò"></a>
              </li>
              <li>
                <a href="#tab4" title="Ï†ÑÏõî Í±¥Ïàò"></a>
              </li>
            </ul>
          </div>

          <div class="tab-contents">
            <div class="tab-row" style="display: flex; width: 100%; gap: 20px; margin-bottom: 3px;">
              <section style="width: 50%; height: 260px; padding: 10px;">
                <div class="tab-item-sub" id="tab1" style="height: 100%">
                  <h5>ÏùºÎ≥Ñ Í±¥Ïàò</h5>
                  <!--<div class="chart-wrap">
                   &lt;!&ndash; <div id="chartHolder1"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                      <canvas id="revenueChart"></canvas>
                  </div>-->
                    <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                        <canvas id="revenueChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                        <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('revenueChart')">zoom_out_map</span>
                    </div>
                </div>
              </section>
              <section style="width: 50%; height: 260px; padding: 10px;">
                <div class="tab-item-sub" id="tab2" style="height: 100%">
                  <h5>ÏõîÎ≥Ñ Í±¥Ïàò</h5>
                 <!-- <div class="chart-wrap">
                    &lt;!&ndash;<div id="chartHolder2"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                      <canvas id="orderChart"></canvas>
                  </div>-->
                    <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                        <canvas id="orderChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                        <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('orderChart')">zoom_out_map</span>
                    </div>
                </div>
              </section>
            </div>
            <div class="tab-row" style="display: flex; width: 100%; gap: 20px; margin-bottom: 3px;">
              <section style="width: 50%; height: 260px; padding: 10px;">
                <div class="tab-item-sub" id="tab3" style="height: 100%">
                  <h5>Î∂ÑÍ∏∞Î≥Ñ Í±¥Ïàò</h5>
                  <!--<div class="chart-wrap">
                    &lt;!&ndash;<div id="chartHolder3"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                      <canvas id="estimateChart"></canvas>
                  </div>-->
                    <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                        <canvas id="estimateChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                        <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('estimateChart')">zoom_out_map</span>
                    </div>
                </div>
              </section>
              <section style="width: 50%; height: 260px; padding: 10px;">
                <div class="tab-item-sub" id="tab4" style="height: 100%">
                  <h5>ÎÖÑÎ≥Ñ Í±¥Ïàò</h5>
                  <!--<div class="chart-wrap">
                    &lt;!&ndash;<div id="chartHolder4"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                      <canvas id="requestChart"></canvas>
                  </div>-->
                    <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                        <canvas id="requestChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                        <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('requestChart')">zoom_out_map</span>
                    </div>
                </div>
              </section>
            </div>
              <div class="tab-row" style="display: flex; width: 100%; gap: 20px; margin-bottom: 3px;">
                  <section style="width: 50%; height: 260px; padding: 10px;">
                      <div class="tab-item-sub" id="tab5" style="height: 100%">
                          <h5>Ï†ÑÎÖÑÎåÄÎπÑ ÏõîÎ≥Ñ Í±¥Ïàò</h5>
                          <!--<div class="chart-wrap">
                            &lt;!&ndash;<div id="chartHolder3"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                              <canvas id="estimateChart"></canvas>
                          </div>-->
                          <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                              <canvas id="lastYearChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                              <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('lastYearChart')">zoom_out_map</span>
                          </div>
                      </div>
                  </section>
                  <section style="width: 50%; height: 260px; padding: 10px;">
                      <div class="tab-item-sub" id="tab6" style="height: 100%">
                          <h5>YTD</h5>
                          <!--<div class="chart-wrap">
                            &lt;!&ndash;<div id="chartHolder4"  style="width: 100%; height: 420px; padding-top: 13px"></div>&ndash;&gt;
                              <canvas id="requestChart"></canvas>
                          </div>-->
                          <div class="chart-wrap" style="justify-content: normal;position: relative;height: 210px;">
                              <canvas id="YTDChart" width="740" height="185" style="width: 740px; height: 185px;"></canvas>
                              <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('YTDChart')">zoom_out_map</span>
                          </div>
                      </div>
                  </section>
              </div>
          </div>
        </section>
      </div>
    </div> <!--//layout-contents end -->
    <footer>
        <p>Copyright‚ìí 0000 corp. All rights reserved.</p>
    </footer>
    </div>

    <div style="height: 10px"></div>

    <div id="chartModal" class="modal" style="opacity:100">
        <div class="modal-content">
            <span class="close">&times;</span>
            <canvas id="modalChartHolder" style="width: 1292px; height: 474px; box-sizing: border-box; display: block;" width="1292" height="474"></canvas>
        </div>
    </div>



</th:block>
<th:block layout:fragment="scripts">
    <th:block th:replace="/common/approve_box :: approve_box"></th:block>
    <th:block th:replace="/common/ax5_uploader :: ax5_uploader"></th:block>
    <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box"></th:block>
    <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/nth-tabs.js"></script>
    <script type="text/javascript">
        // Ïò§Îäò ÎÇ†Ïßú Í∞ÄÏ†∏Ïò§Í∏∞
        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}.${month}.${day}`;
        }

        function updateTitle() {
            const titleElement = document.getElementById("requestDate");
            if (titleElement) {
                titleElement.textContent = `Ï£ºÎ¨∏Îì±Î°ù (${getTodayDate()})`;
            }
        }

        document.addEventListener("DOMContentLoaded", updateTitle);
        // Î™®Îã¨ Ïó¥Í∏∞ Ìï®Ïàò
        function openModal(chartId) {
            // ÏïÑÏù¥ÏΩò Ïà®Í∏∞Í∏∞
            document.querySelector('.material-symbols-outlined').style.display = 'none';

            let chartInstance = $(`#${chartId}`).data('chart'); // ÌÅ¥Î¶≠Îêú Ï∞®Ìä∏Ïùò Ïù∏Ïä§ÌÑ¥Ïä§ Í∞ÄÏ†∏Ïò§Í∏∞
            if (!chartInstance) {
                console.error("Ï∞®Ìä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.");
                return;
            }

            // Î™®Îã¨ Ïó¥Í∏∞
            let modal = $('#chartModal');
            modal.show();

            // Î™®Îã¨ Ï∫îÎ≤ÑÏä§ Ïª®ÌÖçÏä§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
            let modalChartHolder = $('#modalChartHolder')[0].getContext('2d');
            // Í∏∞Ï°¥ Î™®Îã¨ Ï∞®Ìä∏Í∞Ä ÏûàÏúºÎ©¥ ÏÇ≠Ï†ú ÌõÑ ÏÉùÏÑ± (Ï§ëÎ≥µ ÏÉùÏÑ± Î∞©ÏßÄ)
            if (window.modalChartInstance) {
                window.modalChartInstance.destroy();
            }

            // ÏïΩÍ∞ÑÏùò ÏßÄÏó∞ ÌõÑ Ï∞®Ìä∏ ÏÉùÏÑ±ÌïòÏó¨ ÌÅ¨Í∏∞ Î¨∏Ï†ú Ìï¥Í≤∞
            setTimeout(() => {
                window.modalChartInstance = new Chart(modalChartHolder, {
                    type: chartInstance.config.type,
                    data: chartInstance.config.data,
                    options: {
                        ...chartInstance.config.options,
                        responsive: true,
                        maintainAspectRatio: false // Î™®Îã¨ ÌÅ¨Í∏∞Ïóê ÎßûÏ∂îÎèÑÎ°ù ÏÑ§Ï†ï
                    }
                });

                // Í∞ïÏ†úÎ°ú Î¶¨ÏÇ¨Ïù¥Ï¶àÌïòÏó¨ Î™®Îã¨Ïùò ÌÅ¨Í∏∞ ÎßûÏ∂§
                window.modalChartInstance.resize();
            }, 3); // ÏßÄÏó∞ ÏãúÍ∞Ñ Ï°∞Ï†ï
        }
        // ÌéòÏù¥ÏßÄ Î°úÎìú ÌõÑ Î™®Îì† Ï∞®Ìä∏ ÏÉùÏÑ± Î∞è Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
        $(document).ready(function () {

            // Î™®Îã¨ Îã´Í∏∞ Ïù¥Î≤§Ìä∏
            $(document).on('click', '.close', function () {
                $('#chartModal').hide();
                if (window.modalChartInstance) {
                    window.modalChartInstance.destroy();
                    window.modalChartInstance = null; // Ïù∏Ïä§ÌÑ¥Ïä§ Ï¥àÍ∏∞Ìôî
                }
            });

            // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            $(window).on('click', function (event) {
                if ($(event.target).is('#chartModal')) {
                    $('#chartModal').hide();
                    if (window.modalChartInstance) {
                        window.modalChartInstance.destroy();
                        window.modalChartInstance = null; // Ïù∏Ïä§ÌÑ¥Ïä§ Ï¥àÍ∏∞Ìôî
                    }
                    document.querySelector('.material-symbols-outlined').style.display = 'inline'; // ÏïÑÏù¥ÏΩò Îã§Ïãú Î≥¥Ïù¥Í∏∞
                }
            });
        });

        let csrfToken = $("[name=_csrf]").val();

        var swiper = new Swiper(".card-swiper", {
            slidesPerView: 5,
            spaceBetween: 20,
            loop: true,  // Î¨¥Ìïú Î∞òÎ≥µ Ïú†ÏßÄ
            speed: 600,
            autoplay: {
                delay: 2500,
                disableOnInteraction: false,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            on: {
                loopFix: function () {
                    // üî• SwiperÍ∞Ä Î≥µÏ†úÎêú Ïä¨ÎùºÏù¥ÎìúÎ•º ÏõêÎûò ÏúÑÏπòÎ°ú Ï°∞Ï†ïÌï† Îïå Ïã§ÌñâÎê®
                    let slides = document.querySelectorAll(".swiper-slide");
                    slides.forEach(slide => {
                        let index = slide.getAttribute("data-index");
                        let originalSlide = document.querySelector(`.swiper-slide[data-index="${index}"]:not(.swiper-slide-duplicate)`);

                        if (originalSlide) {
                            let bgColor = window.getComputedStyle(originalSlide.querySelector("section")).backgroundColor;
                            let textColor = window.getComputedStyle(originalSlide.querySelector("section")).color;

                            slide.querySelector("section").style.backgroundColor = bgColor;
                            slide.querySelector("section").style.color = textColor;
                        }
                    });
                }
            },
            observer: true,         // Î≥ÄÌôî Í∞êÏßÄ ÌôúÏÑ±Ìôî
            observeParents: true,   // Î∂ÄÎ™® ÏöîÏÜåÏùò Î≥ÄÌôîÎèÑ Í∞êÏßÄ
        });



        document.readyState === 'complete' ? init() : window.onload = init;
        let isBindSpjangcdCalled = false;
        // document.getElementById('search_spjangcd')Î•º Í∏∞Ï§ÄÏúºÎ°ú ÌéòÏù¥ÏßÄ reload
        function init() {
            searchData()
            if (!isBindSpjangcdCalled) {
                bindSpjangcd();
                isBindSpjangcdCalled = true; // ÌîåÎûòÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏
            }
        }
        // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
        function searchData(){
            let data2 = [];
            const ctxRevenue = document.getElementById('revenueChart').getContext('2d');
            const ctxOrder = document.getElementById('orderChart').getContext('2d');
            const ctxEstimate = document.getElementById('estimateChart').getContext('2d');
            const ctxRequest = document.getElementById('requestChart').getContext('2d');

            // Í∏∞Ï°¥ Ï∞®Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§Í∞Ä ÏûàÏúºÎ©¥ Ï†úÍ±∞
            if ($('#revenueChart').data('chart')) {
                $('#revenueChart').data('chart').destroy();
            }
            if ($('#orderChart').data('chart')) {
                $('#orderChart').data('chart').destroy();
            }
            if ($('#estimateChart').data('chart')) {
                $('#estimateChart').data('chart').destroy();
            }
            if ($('#requestChart').data('chart')) {
                $('#requestChart').data('chart').destroy();
            }
            if ($('#lastYearChart').data('chart')) {
                $('#lastYearChart').data('chart').destroy();
            }
            if ($('#YTDChart').data('chart')) {
                $('#YTDChart').data('chart').destroy();
            }
            $.ajax({
                url: '/api/dashboard2/LastYearCnt',
                type: 'GET',
                data: {
                    'search_spjangcd': $('#search_spjangcd').val()
                },
                async: false,
                success: function (data) {
                    data2 = data.data;
                    console.log("data2 : ", data2);

                    // Ï∞®Ìä∏ÏûëÏóÖ
                    // ÏùºÎ≥Ñ Í∑∏ÎûòÌîÑ
                    // ‚úÖ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë
                    let ThisMonthCntOfOrdflag = data2.ThisMonthCntOfOrdflag; // Ïò¨Ìï¥ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞
                    let LastYearCntOfDate = data2.LastYearCntOfDate; // ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞

                    // ‚úÖ XÏ∂ï Î†àÏù¥Î∏î: ÎÇ†Ïßú (YYYY-MM-DD ‚Üí MM-DD ÌòïÏãù)
                    const labels = ThisMonthCntOfOrdflag.map(item => item.reqdate.slice(4, 6) + "-" + item.reqdate.slice(6, 8));

                    // ‚úÖ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Stacked Bar)
                    const stackedBarData = {
                        "ordflag0": ThisMonthCntOfOrdflag.map(item => item.ordfalg0),
                        "ordflag1": ThisMonthCntOfOrdflag.map(item => item.ordfalg1),
                        "ordflag2": ThisMonthCntOfOrdflag.map(item => item.ordfalg2),
                        "ordflag3": ThisMonthCntOfOrdflag.map(item => item.ordfalg3),
                        "ordflag4": ThisMonthCntOfOrdflag.map(item => item.ordfalg4),
                        "ordflag5": ThisMonthCntOfOrdflag.map(item => item.ordfalg5)
                    };

                    // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Line Chart)
                    const lineData = LastYearCntOfDate.map(item => item.last_year_totalCnt);

                    // ‚úÖ Stacked Bar + Line Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData = {
                        labels: labels,
                        datasets: [
                            {
                                label: "Îì±Î°ù",
                                type: 'bar',
                                data: stackedBarData["ordflag0"],
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏù∏",
                                type: 'bar',
                                data: stackedBarData["ordflag1"],
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏ†ï",
                                type: 'bar',
                                data: stackedBarData["ordflag2"],
                                backgroundColor: 'rgba(255, 206, 86, 0.7)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏßÑÌñâ",
                                type: 'bar',
                                data: stackedBarData["ordflag3"],
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∂úÍ≥†",
                                type: 'bar',
                                data: stackedBarData["ordflag4"],
                                backgroundColor: 'rgba(153, 102, 255, 0.7)',
                                borderColor: 'rgba(153, 102, 255, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∑®ÏÜå",
                                type: 'bar',
                                data: stackedBarData["ordflag5"],
                                backgroundColor: 'rgba(255, 159, 64, 0.7)',
                                borderColor: 'rgba(255, 159, 64, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏûëÎÖÑ Í±¥Ïàò",
                                type: 'line',
                                data: lineData,
                                borderColor: 'rgba(0, 200, 0, 1)',
                                backgroundColor: 'rgba(0, 200, 0, 0.5)',
                                borderWidth: 2,
                                tension: 0.4, // Í≥°ÏÑ†Ìòï ÎùºÏù∏
                                yAxisID: 'y1' // Î≥ÑÎèÑÏùò YÏ∂ï ÏÇ¨Ïö©
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                stacked: true
                            },
                            y: {
                                stacked: true,
                                beginAtZero: true,
                                position: 'left'
                            },
                            y1: { // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞Î•º ÏúÑÌïú Î≥ÑÎèÑÏùò YÏ∂ï
                                beginAtZero: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false // Bar ChartÏôÄ Í≤πÏπòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value; // Îã®ÏúÑ Ï∂îÍ∞Ä
                                    }
                                }
                            }
                        }
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx = document.getElementById('revenueChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData,
                        options: chartOptions
                    });

                    // ÏõîÎ≥Ñ Í∑∏ÎûòÌîÑ
                    // ‚úÖ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë
                    let ThisYearCntOfOrdflagByMonth = data2.ThisYearCntOfOrdflagByMonth; // Ïò¨Ìï¥ ÏõîÎ≥Ñ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞
                    let LastYearCntOfDateByMonth = data2.LastYearCntOfDateByMonth; // ÏûëÎÖÑ ÏõîÎ≥Ñ Ï¥ù Îç∞Ïù¥ÌÑ∞

                    // ‚úÖ XÏ∂ï Î†àÏù¥Î∏î: Ïõî (YYYY-MM ‚Üí MMÏõî ÌòïÏãù)
                    const labels2 = ThisYearCntOfOrdflagByMonth.map(item => item.reqmonth.slice(-2) + "Ïõî");

                    // ‚úÖ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Stacked Bar)
                    const stackedBarData2 = {
                        "ordflag0": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg0),
                        "ordflag1": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg1),
                        "ordflag2": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg2),
                        "ordflag3": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg3),
                        "ordflag4": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg4),
                        "ordflag5": ThisYearCntOfOrdflagByMonth.map(item => item.ordfalg5)
                    };

                    // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Line Chart)
                    const lineData2 = LastYearCntOfDateByMonth.map(item => item.last_year_totalCnt);

                    // ‚úÖ Stacked Bar + Line Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData2 = {
                        labels: labels2,
                        datasets: [
                            {
                                label: "Îì±Î°ù",
                                type: 'bar',
                                data: stackedBarData2["ordflag0"],
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏù∏",
                                type: 'bar',
                                data: stackedBarData2["ordflag1"],
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏ†ï",
                                type: 'bar',
                                data: stackedBarData2["ordflag2"],
                                backgroundColor: 'rgba(255, 206, 86, 0.7)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏßÑÌñâ",
                                type: 'bar',
                                data: stackedBarData2["ordflag3"],
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∂úÍ≥†",
                                type: 'bar',
                                data: stackedBarData2["ordflag4"],
                                backgroundColor: 'rgba(153, 102, 255, 0.7)',
                                borderColor: 'rgba(153, 102, 255, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∑®ÏÜå",
                                type: 'bar',
                                data: stackedBarData2["ordflag5"],
                                backgroundColor: 'rgba(255, 159, 64, 0.7)',
                                borderColor: 'rgba(255, 159, 64, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏûëÎÖÑ Í±¥Ïàò",
                                type: 'line',
                                data: lineData2,
                                borderColor: 'rgba(0, 200, 0, 1)',
                                backgroundColor: 'rgba(0, 200, 0, 0.5)',
                                borderWidth: 2,
                                tension: 0.4, // Í≥°ÏÑ†Ìòï ÎùºÏù∏
                                yAxisID: 'y1' // Î≥ÑÎèÑÏùò YÏ∂ï ÏÇ¨Ïö©
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions2 = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: { stacked: true },
                            y: {
                                stacked: true,
                                beginAtZero: true,
                                position: 'left'
                            },
                            y1: { // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞Î•º ÏúÑÌïú Î≥ÑÎèÑÏùò YÏ∂ï
                                beginAtZero: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false // Bar ChartÏôÄ Í≤πÏπòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value; // Îã®ÏúÑ Ï∂îÍ∞Ä
                                    }
                                }
                            }
                        }
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx2 = document.getElementById('orderChart').getContext('2d');
                    new Chart(ctx2, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData2,
                        options: chartOptions2
                    });

                    // Î∂ÑÍ∏∞Î≥Ñ Í∑∏ÎûòÌîÑ
                    // ‚úÖ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë
                    let ThisYearCntOfOrdflagByQuarter = data2.ThisYearCntOfOrdflagByQuarter; // Ïò¨Ìï¥ Î∂ÑÍ∏∞Î≥Ñ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞
                    let LastYearCntOfDateByQuarter = data2.LastYearCntOfDateByQuarter; // ÏûëÎÖÑ Î∂ÑÍ∏∞Î≥Ñ Ï¥ù Îç∞Ïù¥ÌÑ∞

                    // ‚úÖ XÏ∂ï Î†àÏù¥Î∏î: Î∂ÑÍ∏∞ (YYYY-Q ‚Üí QÎ∂ÑÍ∏∞ ÌòïÏãù)
                    const labels3 = ThisYearCntOfOrdflagByQuarter.map(item => item.reqquarter.slice(-1) + "Î∂ÑÍ∏∞");

                    // ‚úÖ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Stacked Bar)
                    const stackedBarData3 = {
                        "ordflag0": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg0),
                        "ordflag1": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg1),
                        "ordflag2": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg2),
                        "ordflag3": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg3),
                        "ordflag4": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg4),
                        "ordflag5": ThisYearCntOfOrdflagByQuarter.map(item => item.ordfalg5)
                    };

                    // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Line Chart)
                    const lineData3 = LastYearCntOfDateByQuarter.map(item => item.last_year_totalCnt);

                    // ‚úÖ Stacked Bar + Line Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData3 = {
                        labels: labels3,
                        datasets: [
                            {
                                label: "Îì±Î°ù",
                                type: 'bar',
                                data: stackedBarData3["ordflag0"],
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏù∏",
                                type: 'bar',
                                data: stackedBarData3["ordflag1"],
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏ†ï",
                                type: 'bar',
                                data: stackedBarData3["ordflag2"],
                                backgroundColor: 'rgba(255, 206, 86, 0.7)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏßÑÌñâ",
                                type: 'bar',
                                data: stackedBarData3["ordflag3"],
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∂úÍ≥†",
                                type: 'bar',
                                data: stackedBarData3["ordflag4"],
                                backgroundColor: 'rgba(153, 102, 255, 0.7)',
                                borderColor: 'rgba(153, 102, 255, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∑®ÏÜå",
                                type: 'bar',
                                data: stackedBarData3["ordflag5"],
                                backgroundColor: 'rgba(255, 159, 64, 0.7)',
                                borderColor: 'rgba(255, 159, 64, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏûëÎÖÑ Í±¥Ïàò",
                                type: 'line',
                                data: lineData3,
                                borderColor: 'rgba(0, 200, 0, 1)',
                                backgroundColor: 'rgba(0, 200, 0, 0.5)',
                                borderWidth: 2,
                                tension: 0.4, // Í≥°ÏÑ†Ìòï ÎùºÏù∏
                                yAxisID: 'y1' // Î≥ÑÎèÑÏùò YÏ∂ï ÏÇ¨Ïö©
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions3 = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: { stacked: true },
                            y: {
                                stacked: true,
                                beginAtZero: true,
                                position: 'left'
                            },
                            y1: { // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞Î•º ÏúÑÌïú Î≥ÑÎèÑÏùò YÏ∂ï
                                beginAtZero: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false // Bar ChartÏôÄ Í≤πÏπòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value; // Îã®ÏúÑ Ï∂îÍ∞Ä
                                    }
                                }
                            }
                        }
                    };

                    // ÎÖÑÎ≥Ñ Í∑∏ÎûòÌîÑ
                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx3 = document.getElementById('estimateChart').getContext('2d');
                    new Chart(ctx3, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData3,
                        options: chartOptions3
                    });
                    // ‚úÖ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë
                    let LastFiveYearsCntOfOrdflag = data2.LastFiveYearsCntOfOrdflag; // ÏµúÍ∑º 5ÎÖÑÍ∞Ñ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞

                    // ‚úÖ XÏ∂ï Î†àÏù¥Î∏î: Ïó∞ÎèÑ (YYYY)
                    const labels4 = LastFiveYearsCntOfOrdflag.map(item => item.reqyear);

                    // ‚úÖ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨ (Stacked Bar)
                    const stackedBarData4 = {
                        "ordflag0": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg0),
                        "ordflag1": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg1),
                        "ordflag2": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg2),
                        "ordflag3": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg3),
                        "ordflag4": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg4),
                        "ordflag5": LastFiveYearsCntOfOrdflag.map(item => item.ordfalg5)
                    };

                    // ‚úÖ Stacked Bar Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData4 = {
                        labels: labels4,
                        datasets: [
                            {
                                label: "Îì±Î°ù",
                                type: 'bar',
                                data: stackedBarData4["ordflag0"],
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏù∏",
                                type: 'bar',
                                data: stackedBarData4["ordflag1"],
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÌôïÏ†ï",
                                type: 'bar',
                                data: stackedBarData4["ordflag2"],
                                backgroundColor: 'rgba(255, 206, 86, 0.7)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "ÏßÑÌñâ",
                                type: 'bar',
                                data: stackedBarData4["ordflag3"],
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∂úÍ≥†",
                                type: 'bar',
                                data: stackedBarData4["ordflag4"],
                                backgroundColor: 'rgba(153, 102, 255, 0.7)',
                                borderColor: 'rgba(153, 102, 255, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            },
                            {
                                label: "Ï∑®ÏÜå",
                                type: 'bar',
                                data: stackedBarData4["ordflag5"],
                                backgroundColor: 'rgba(255, 159, 64, 0.7)',
                                borderColor: 'rgba(255, 159, 64, 1)',
                                borderWidth: 1,
                                stack: 'stacked'
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions4 = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: { stacked: true },
                            y: {
                                stacked: true,
                                beginAtZero: true,
                                position: 'left'
                            }
                        }
                    };
                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx4 = document.getElementById('requestChart').getContext('2d');
                    new Chart(ctx4, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData4,
                        options: chartOptions4
                    });

                    // Ï†ÑÎÖÑÎåÄÎπÑ ÏõîÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Í±¥Ïàò Í∑∏ÎûòÌîÑ
                    // ‚úÖ Ïò¨Ìï¥ Î∞è ÏûëÎÖÑ Ï¥ù Îç∞Ïù¥ÌÑ∞ Í∞úÏàò Ï∂îÏ∂ú
                    const thisYearTotal = ThisYearCntOfOrdflagByMonth.map(item => item.totalCnt);
                    const lastYearTotal = LastYearCntOfDateByMonth.map(item => item.last_year_totalCnt);

                    // ‚úÖ Ï¶ùÍ∞êÏú®(%) Í≥ÑÏÇ∞ (Ï¶ùÍ∞êÏú® = ((Ïò¨Ìï¥ - ÏûëÎÖÑ) / ÏûëÎÖÑ) * 100)
                    const growthRate = thisYearTotal.map((count, i) =>
                        lastYearTotal[i] !== 0 ? ((count - lastYearTotal[i]) / lastYearTotal[i]) * 100 : 0
                    );

                    // ‚úÖ Stacked Bar + Line Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData5 = {
                        labels: labels2,
                        datasets: [
                            {
                                label: "Ïò¨Ìï¥ Í±¥Ïàò",
                                type: 'bar',
                                data: thisYearTotal,
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1
                            },
                            {
                                label: "Ï†ÑÎÖÑÎèÑ Í±¥Ïàò",
                                type: 'bar',
                                data: lastYearTotal,
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1
                            },
                            {
                                label: "Ï¶ùÍ∞êÏú®(%)",
                                type: 'line',
                                data: growthRate,
                                borderColor: 'rgba(0, 200, 0, 1)',
                                backgroundColor: 'rgba(0, 200, 0, 0.5)',
                                borderWidth: 2,
                                tension: 0.4, // Í≥°ÏÑ†Ìòï ÎùºÏù∏
                                yAxisID: 'y1' // Î≥ÑÎèÑÏùò YÏ∂ï ÏÇ¨Ïö©
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions5 = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: { stacked: false },
                            y: {
                                beginAtZero: true,
                                position: 'left'
                            },
                            y1: { // ‚úÖ Ï¶ùÍ∞êÎüâ(Line Chart) Î≥ÑÎèÑÏùò YÏ∂ï ÏÑ§Ï†ï
                                beginAtZero: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false // Bar ChartÏôÄ Í≤πÏπòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value; // Îã®ÏúÑ Ï∂îÍ∞Ä
                                    }
                                }
                            }
                        }
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx5 = document.getElementById('lastYearChart').getContext('2d');
                    new Chart(ctx5, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData5,
                        options: chartOptions5
                    });

                    // YTD Í∑∏ÎûòÌîÑ
                    // ‚úÖ Îç∞Ïù¥ÌÑ∞ Îß§Ìïë
                    let ThisYearCntOfStacked = data2.ThisYearCntOfStacked; // Ïò¨Ìï¥ YTD
                    let LastYearCntOfStacked = data2.LastYearCntOfStacked; // ÏûëÎÖÑ YTD

                    // ‚úÖ XÏ∂ï Î†àÏù¥Î∏î: Ïõî (YYYY-MM ‚Üí MMÏõî ÌòïÏãù)
                    const labels6 = ThisYearCntOfStacked.map(item => item.reqmonth.slice(-2) + "Ïõî");

                    const thisYearTotal6 = ThisYearCntOfStacked.map(item => item.totalCnt);
                    const lastYearTotal6 = LastYearCntOfStacked.map(item => item.last_year_totalCnt);
                    // ‚úÖ Ï¶ùÍ∞êÏú®(%) Í≥ÑÏÇ∞ (Ï¶ùÍ∞êÏú® = ((Ïò¨Ìï¥ - ÏûëÎÖÑ) / ÏûëÎÖÑ) * 100)
                    const growthRate6 = thisYearTotal6.map((count, i) =>
                        lastYearTotal6[i] !== 0 ? ((count - lastYearTotal6[i]) / lastYearTotal6[i]) * 100 : 0
                    );
                    // ‚úÖ Stacked Bar + Line Chart Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                    const chartData6 = {
                        labels: labels6,
                        datasets: [
                            {
                                label: "Ïò¨Ìï¥ Í±¥Ïàò",
                                type: 'bar',
                                data: thisYearTotal6,
                                backgroundColor: 'rgba(98, 178, 253, 0.7)',
                                borderColor: 'rgba(98, 178, 253, 1)',
                                borderWidth: 1
                            },
                            {
                                label: "Ï†ÑÎÖÑÎèÑ Í±¥Ïàò",
                                type: 'bar',
                                data: lastYearTotal6,
                                backgroundColor: 'rgba(253, 98, 98, 0.7)',
                                borderColor: 'rgba(253, 98, 98, 1)',
                                borderWidth: 1
                            },
                            {
                                label: "Ï¶ùÍ∞êÏú®(%)",
                                type: 'line',
                                data: growthRate6,
                                borderColor: 'rgba(0, 200, 0, 1)',
                                backgroundColor: 'rgba(0, 200, 0, 0.5)',
                                borderWidth: 2,
                                tension: 0.4, // Í≥°ÏÑ†Ìòï ÎùºÏù∏
                                yAxisID: 'y1' // Î≥ÑÎèÑÏùò YÏ∂ï ÏÇ¨Ïö©
                            }
                        ]
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏòµÏÖò ÏÑ§Ï†ï
                    const chartOptions6 = {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: { stacked: false },
                            y: {
                                stacked: false,
                                beginAtZero: true,
                                position: 'left'
                            },
                            y1: { // ‚úÖ ÏûëÎÖÑ Îç∞Ïù¥ÌÑ∞Î•º ÏúÑÌïú Î≥ÑÎèÑÏùò YÏ∂ï
                                beginAtZero: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false // Bar ChartÏôÄ Í≤πÏπòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value; // Îã®ÏúÑ Ï∂îÍ∞Ä
                                    }
                                }
                            }
                        }
                    };

                    // ‚úÖ Ï∞®Ìä∏ ÏÉùÏÑ±
                    const ctx6 = document.getElementById('YTDChart').getContext('2d');
                    new Chart(ctx6, {
                        type: 'bar', // Í∏∞Î≥∏ Ï∞®Ìä∏ Ïú†Ìòï
                        data: chartData6,
                        options: chartOptions6
                    });

                    // Ïπ¥Îìú ÏûëÏóÖ
                    // ÏûëÎÖÑ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞
                    let LastYearCnt = data2.LastYearCnt;
                    // Ïò¨Ìï¥ ÏÉÅÌÉúÍ∞íÎ≥Ñ Îç∞Ïù¥ÌÑ∞
                    let ThisYearCnt = data2.ThisYearCnt;
                    // ordflagÍ∞Ä 0Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf0 = LastYearCnt.find(item => item.ordflag === '0')?.TotalCount || 0;
                    const thisYearCountOf0 = ThisYearCnt.find(item => item.ordflag === '0')?.TotalCount || 0;
                    // Îëê Í∞íÏùò Ï∞®Ïù¥ Í≥ÑÏÇ∞
                    const difference0 = thisYearCountOf0 - lastYearCountOf0;
                    // Í≤∞Í≥ºÎ•º HTMLÏóê ÏóÖÎç∞Ïù¥Ìä∏
                    const requestSection = document.querySelector('.request dl dd');
                    if(difference0 >= 0) {
                        requestSection.innerHTML = `<span class="up"></span> ${difference0} <span class="unit">Í±¥</span>`;
                    }else{
                        requestSection.innerHTML = `<span class="down"></span> ${difference0} <span class="unit">Í±¥</span>`;
                    }
                    // ordflagÍ∞Ä 1Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf1 = LastYearCnt.find(item => item.ordflag === '1')?.TotalCount || 0;
                    const thisYearCountOf1 = ThisYearCnt.find(item => item.ordflag === '1')?.TotalCount || 0;
                    const difference1 = thisYearCountOf1 - lastYearCountOf1;
                    const checkSection = document.querySelector('.check dl dd');
                    checkSection.innerHTML = `${thisYearCountOf1} <span class="unit">Í±¥</span>`;
                    // ordflagÍ∞Ä 2Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf2 = LastYearCnt.find(item => item.ordflag === '2')?.TotalCount || 0;
                    const thisYearCountOf2 = ThisYearCnt.find(item => item.ordflag === '2')?.TotalCount || 0;
                    const difference2 = thisYearCountOf2 - lastYearCountOf2;
                    const orderSection = document.querySelector('.order dl dd');
                    orderSection.innerHTML = `${thisYearCountOf2} <span class="unit">Í±¥</span>`;
                    // ordflagÍ∞Ä 3Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf3 = LastYearCnt.find(item => item.ordflag === '3')?.TotalCount || 0;
                    const thisYearCountOf3 = ThisYearCnt.find(item => item.ordflag === '3')?.TotalCount || 0;
                    const difference3 = thisYearCountOf3 - lastYearCountOf3;
                    const productSection = document.querySelector('.product dl dd');
                    productSection.innerHTML = `${thisYearCountOf3} <span class="unit">Í±¥</span>`;
                    // ordflagÍ∞Ä 4Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf4 = LastYearCnt.find(item => item.ordflag === '4')?.TotalCount || 0;
                    const thisYearCountOf4 = ThisYearCnt.find(item => item.ordflag === '4')?.TotalCount || 0;
                    const difference4 = thisYearCountOf4 - lastYearCountOf4;
                    const deliverySection = document.querySelector('.delivery dl dd');
                    deliverySection.innerHTML = `${thisYearCountOf4} <span class="unit">Í±¥</span>`;
                    // ordflagÍ∞Ä 5Ïù∏ TotalCount Ï∂îÏ∂ú
                    const lastYearCountOf5 = LastYearCnt.find(item => item.ordflag === '5')?.TotalCount || 0;
                    const thisYearCountOf5 = ThisYearCnt.find(item => item.ordflag === '5')?.TotalCount || 0;
                    const difference5 = thisYearCountOf5 - lastYearCountOf5;
                    const cancelSection = document.querySelector('.cancel dl dd');
                    cancelSection.innerHTML = `${thisYearCountOf5} <span class="unit">Í±¥</span>`;
                }
            })
        }
        function bindSpjangcd() {
            $.ajax({
                url: '/api/dashboard2/bindSpjangcd',
                type: 'GET',
                async: false,
                success: function (data) {
                    data2 = data.data;
                    const selectElement = document.getElementById('search_spjangcd');
                    if (selectElement) {
                        selectElement.value = data2; // value ÏÜçÏÑ±ÏúºÎ°ú ÏÑ†ÌÉù
                    }
                }
            })
        }
        // Í∞ÄÏù¥Îìú web ÌåùÏóÖÏ∞Ω Ïó¥Í∏∞
        function openPopup(url) {
            // ÏÉà Ï∞Ω Ïó¥Í∏∞
            window.open(url, '_blank',
                'width=1040,height=1000,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes');
        }
        // Ï£ºÎ¨∏ÏÉÅÌÉúÎ≥Ñ Ïπ¥Îìú ÌÅ¥Î¶≠Ïãú Ï£ºÎ¨∏ÌôïÏù∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
        $(document).ready(function () {
            $(".request, .check, .order, .product, .delivery, .cancel").click(function () {
                var section = $(this).attr("class"); // ÌÅ¥Î¶≠Ìïú Î≤ÑÌäºÏùò ÌÅ¥ÎûòÏä§ Í∞ÄÏ†∏Ïò§Í∏∞
                var searchStateValue = getSearchState(section); // Ìï¥Îãπ ÏÑπÏÖòÏóê ÎßûÎäî searchState Í∞ÄÏ†∏Ïò§Í∏∞

                // sessionStorageÏóê Ï†ÄÏû•
                sessionStorage.setItem("activeSection", section);
                sessionStorage.setItem("searchState", searchStateValue);

                // postMessageÎ°ú ÌÉ≠ Ï∂îÍ∞Ä ÏöîÏ≤≠
                window.parent.postMessage({
                    action: "addTab",
                    id: "order_status",
                    title: "Ï£ºÎ¨∏ÌòÑÌô©",
                    url: '/gui/' + "order_status" + '/default',
                    active: true,
                    allowClose: true,
                }, "*");
            });

            // searchState Í∞íÏùÑ Î∞òÌôòÌïòÎäî Î©îÏÑúÎìú
            function getSearchState(section) {
                var stateMapping = {
                    "request": "0",
                    "check": "1",
                    "order": "2",
                    "product": "3",
                    "delivery": "4",
                    "cancel": "5"
                };
                return stateMapping[section] || "0"; // Îß§ÌïëÎêú Í∞íÏù¥ ÏóÜÏúºÎ©¥ default Î∞òÌôò
            }
        });


    </script>
</th:block>
</html>